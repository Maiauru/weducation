<?xml version="1.0" encoding="UTF-8"?>

<databaseChangeLog
  xmlns="http://www.liquibase.org/xml/ns/dbchangelog/1.9"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog/1.9
  http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-1.9.xsd">

<changeSet id="005-1" author="gooamoko">
  <comment>
    Создадим таблицу для хранения семестров групп
  </comment>
  <sql>
    CREATE TABLE groupsemesters(
    grs_pcode serial,
    grs_course int NOT NULL,
    grs_semester int NOT NULL,
    grs_beginweek int NOT NULL,
    grs_beginmonth int NOT NULL,
    grs_beginyear int NOT NULL,
    grs_endweek int NOT NULL,
    grs_endmonth int NOT NULL,
    grs_endyear int NOT NULL,
    grs_grpcode int NOT NULL,
    CONSTRAINT groupsemesters_pk PRIMARY KEY(grs_pcode),
    CONSTRAINT groupsemesters_groups_fk FOREIGN KEY(grs_grpcode) REFERENCES groups(grp_pcode) ON UPDATE CASCADE ON DELETE CASCADE,
    CONSTRAINT unique_semester UNIQUE(grs_course, grs_semester, grs_grpcode)
    );
  </sql>
</changeSet>

</databaseChangeLog>