<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core">

  <ui:composition template="/WEB-INF/templates/main.xhtml">
    <ui:define name="content">
      <script src="#{request.contextPath}/js/script.js" type="text/javascript"></script>
      <h1>Рабочее место отделения "#{departmentRootMB.department.name}"</h1>
      <h3><a href="javascript:toggle('details')">Параметры отделения</a></h3>
      <div id="details" style="display: none;">
        <h:form id="detailsForm">
          <h:outputText value="Зав. отделением" /><br />
          <h:outputText rendered="#{not departmentRootMB.edit}" value="#{departmentRootMB.department.master}" />
          <h:inputText class="textEdit" rendered="#{departmentRootMB.edit}" value="#{departmentRootMB.department.master}" />
          <p />
          <h:outputText value="Секретарь" /><br />
          <h:outputText rendered="#{not departmentRootMB.edit}" value="#{departmentRootMB.department.secretar}" />
          <h:inputText class="textEdit" rendered="#{departmentRootMB.edit}" value="#{departmentRootMB.department.secretar}" />
          <p />
          <h:commandButton action="#{departmentRootMB.toggleEdit()}" value="#{departmentRootMB.editLabel}">
            <f:ajax execute="@form" render="@form" />
          </h:commandButton>
        </h:form>
      </div>
      <h3><a href="javascript:toggle('groups')">Группы и студенты</a></h3>
      <div id="groups" style="display: none;">
        <h:form id="groupAndPersonsForm">
          <p>
            <h:outputText value="Группа " />
            <h:selectOneMenu valueChangeListener="#{departmentRootMB.changeGroup}" value="#{departmentRootMB.groupCode}">
              <f:selectItem itemLabel="--- Выберите группу ----" itemValue="0" />
              <f:selectItems value="#{departmentRootMB.groupList}" var="group"
                             itemLabel="#{group.name}" itemValue="#{group.id}" />
              <f:ajax execute="@this" render="@form"/>
            </h:selectOneMenu>
          </p>
          <table id="dataTable">
            <thead>
              <tr>
                <th width="70%">Фамилия Имя Отчество</th>
                <th width="30%">Данные</th>
              </tr>
            </thead>
            <tbody>
              <ui:repeat value="#{departmentRootMB.students}" var="student">
                <tr class="#{departmentRootMB.getStudentClass(student.active)}">
                  <td>${student.person.fullName}</td>
                  <td>
                    <h:link target="new" class="action" value="Персона" outcome="/persons?id=#{student.person.id}" />
                    <h:link target="new" class="action" value="Карточка" outcome="/studycards?id=#{student.id}" />
                  </td>
                </tr>
              </ui:repeat>
            </tbody>
          </table>
        </h:form>
      </div>
      <h3><a href="javascript:toggle('reports')">Сформировать отчет(ы)</a></h3>
      <div id="reports" style="display: none;">
        <p>
          Раздел находится в разработке.
        </p>
      </div>
    </ui:define>
  </ui:composition>
</html>
