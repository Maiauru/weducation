<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core">

  <f:metadata>
    <f:viewParam name="groupId" value="#{monthMarksMB.personCode}" />
    <f:viewAction action="#{monthMarksMB.preparePage()}" />
  </f:metadata>  

  <ui:composition template="/WEB-INF/templates/main.xhtml">
    <ui:define name="content">
      <h:panelGroup layout="block" rendered="#{monthMarksMB.edit}">
        <!-- Edit -->
        <h2>Редактирование оценок за месяц</h2>
        <h:form>
          <h:outputText value="Subject" /><br />
          <h:selectOneMenu value="#{monthMarksMB.subjectCode}"
                           valueChangeListener="#{monthMarksMB.changeSubject}">
            <f:selectItem itemLabel="---select subject---" itemValue="0" />
            <f:selectItems value="#{monthMarksMB.subjectsForGroup}" var="sub" 
                           itemLabel="#{sub.name}" itemValue="#{sub.id}" />
            <f:ajax event="change" execute="@form" render="@form globalMessages" />
          </h:selectOneMenu><p />
          <h:outputText value="Year" /><br />
          <h:inputText value="#{monthMarksMB.year}" class="textEdit" /><p />
          <h:outputText value="Month" /><br />
          <h:inputText value="#{monthMarksMB.month}" class="textEdit" /><p />

          <!-- And now I confused: how implement list of persons?
          If it will be ui:repeat - what should I use for value="" parameter?
          -->

          <div class="buttons">
            <h:commandButton value="Сохранить" action="#{monthMarksMB.save()}" />
            <h:commandButton value="Отменить" action="#{monthMarksMB.cancel()}" />
          </div>
        </h:form>
      </h:panelGroup>
      <h:panelGroup rendered="#{monthMarksMB.error}">
        <!-- Error -->
        <h2>Ошибка!</h2>
        <div class="roundbox" id="error">
          Вы оказались там где быть не должны! Либо что-то случилось, либо одно из двух :-).
          Если вы уверены в том, что всё делали правильно, сообщите разработчику об этой ошибке.
        </div>
        <p><h:link outcome="/index" value="Перейти на главную страницу" /></p>
      </h:panelGroup>
    </ui:define>
  </ui:composition>
</html>
